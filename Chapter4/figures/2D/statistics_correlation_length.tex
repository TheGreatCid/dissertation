\begin{figure}[htb!]
  \centering
  \begin{subfigure}[b]{0.475\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter4/2D/dimensionless_curve_correlation_length_sqexp}
    \begin{tikzpicture}
      \begin{axis}[
          width=0.9\textwidth,
          height=1.1\textwidth,
          ymode=log,
          log ticks with fixed point,
          ylabel=$\underline{l^*}$,xlabel=$\mathcal{D}^*$,
          % ymin=0,ymax=2.5,
          legend style={
              at={(0.05,0.05)},
              anchor=south west,
              nodes={scale=1, transform shape},
              fill=none,
              draw=none,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick}
        ]
        % sqexp l = 5
        \addplot [select coords between index={40}{220},color=black] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/dimensionless_curve_sqexp_cartesian_5_5.csv};
        % sqexp l = 10
        \addplot [select coords between index={40}{220},color=red] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/dimensionless_curve_sqexp_cartesian_10_10.csv};
        % sqexp l = 20
        \addplot [select coords between index={40}{220},color=blue] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/dimensionless_curve_sqexp_cartesian_20_20.csv};
        \legend{sqexp $L^* = 0.05$,sqexp $L^* = 0.1$,sqexp $L^* = 0.2$}
      \end{axis}
    \end{tikzpicture}
    \caption{}
    \label{fig: Chapter4/2D/dimensionless_curve_correlation_length_sqexp}
  \end{subfigure}
  \begin{subfigure}[b]{0.475\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter4/2D/distribution_correlation_length_sqexp}
    \begin{tikzpicture}
      \begin{axis}[
          width=0.9\textwidth,
          height=1.1\textwidth,
          xlabel=$l^*$,ylabel=estimated PDF,
          ymin=0,ymax=0.012,
          xmin=0,xmax=1000,
          legend style={at={(0.95,0.95)},anchor=north east},
          legend style={nodes={scale=1, transform shape}},
          legend style={fill=none,draw=none},
          legend cell align={left},
          every axis plot/.append style={thick}
        ]
        \addplot [color=black] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/distribution_sqexp_cartesian_5_5.csv};
        \addplot [color=red] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/distribution_sqexp_cartesian_10_10.csv};
        \addplot [color=blue] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/distribution_sqexp_cartesian_20_20.csv};
        \legend{sqexp $L^* = 0.05$,sqexp $L^* = 0.1$,sqexp $L^* = 0.2$}
      \end{axis}
    \end{tikzpicture}
    \caption{}
    \label{fig: Chapter4/2D/distribution_correlation_length_sqexp}
  \end{subfigure}
  
  \begin{subfigure}[b]{0.475\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter4/2D/dimensionless_curve_correlation_length_exp}
    \begin{tikzpicture}
      \begin{axis}[
          width=0.9\textwidth,
          height=1.1\textwidth,
          ymode=log,
          log ticks with fixed point,
          ylabel=$\underline{l^*}$,xlabel=$\mathcal{D}^*$,
          % ymin=0,ymax=2.5,
          legend style={
              at={(0.05,0.05)},
              anchor=south west,
              nodes={scale=1, transform shape},
              fill=none,
              draw=none,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick}
        ]
        % sqexp l = 5
        \addplot [select coords between index={40}{220},color=black] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/dimensionless_curve_exp_cartesian_5_5.csv};
        % sqexp l = 10
        \addplot [select coords between index={40}{220},color=red] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/dimensionless_curve_exp_cartesian_10_10.csv};
        % sqexp l = 20
        \addplot [select coords between index={40}{220},color=blue] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/dimensionless_curve_exp_cartesian_20_20.csv};
        \legend{exp $L^* = 0.05$,exp $L^* = 0.1$,exp $L^* = 0.2$}
      \end{axis}
    \end{tikzpicture}
    \caption{}
    \label{fig: Chapter4/2D/dimensionless_curve_correlation_length_exp}
  \end{subfigure}
  \begin{subfigure}[b]{0.475\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter4/2D/distribution_correlation_length_exp}
    \begin{tikzpicture}
      \begin{axis}[
          width=0.9\textwidth,
          height=1.1\textwidth,
          xlabel=$l^*$,ylabel=estimated PDF,
          ymin=0,ymax=0.012,
          xmin=0,xmax=300,
          legend style={at={(0.95,0.95)},anchor=north east},
          legend style={nodes={scale=1, transform shape}},
          legend style={fill=none,draw=none},
          legend cell align={left},
          every axis plot/.append style={thick}
        ]
        \addplot [color=black] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/distribution_exp_cartesian_5_5.csv};
        \addplot [color=red] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/distribution_exp_cartesian_10_10.csv};
        \addplot [color=blue] table [x expr=\thisrowno{0},y expr=\thisrowno{1}]{Chapter4/data/2D/distribution_exp_cartesian_20_20.csv};
        \legend{exp $L^* = 0.05$,exp $L^* = 0.1$,exp $L^* = 0.2$}
      \end{axis}
    \end{tikzpicture}
    \caption{}
    \label{fig: Chapter4/2D/distribution_correlation_length_exp}
  \end{subfigure}
  \caption{(a, c) Mean dimensionless crack spacing $\underline{l^*}$ versus dimensionless crack driving force $\mathcal{D}^*$ (b, d) Estimated probability density of dimensionless crack spacing for different values of correlation length when $\mathcal{D}^* = 5.17$ based on (a-b) a PSE kernel (c-d) a PE kernel }
  \label{fig: Chapter4/2D/statistics_correlation_length}
\end{figure}
