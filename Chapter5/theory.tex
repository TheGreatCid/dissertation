\section{Theory}
\label{section: Chapter5/theory}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Constitutive choices}

Following the variational framework (\Cref{chapter: framework}), the Helmholtz free energy density is decomposed as
\begin{align}
  \psi = \psi^e + \psi^p + \psi^f, \label{eq: chapter 5 helmholtz}
\end{align}
where $\psi^e$, $\psi^p$ and $\psi^f$ are the strain-energy density, plastic energy density, and fracture energy density, respectively. The strain-energy density for large deformation and the plastic energy density, along with the flow rule constraints and their thermodynamic conjugates, are presented in the following sections. The same Allen-Cahn type fracture energy density (as per \Cref{section: Chapter3,section: Chapter4}) is used in this chapter.

The dual kinetic potential characterizing dissipation mechanisms is decomposed as
\begin{align}
  \Delta^* = {\psi^e}^* + {\psi^p}^* + {\psi^f}^*, \label{eq: chapter 5 dual kinetic potential}
\end{align}
where ${\psi^e}^*$, ${\psi^p}^*$ and ${\psi^f}^*$ are viscous dissipations of their energetic counterparts. Again, the same superscripts are used only for convenience notation-wise, they are not to be confused with Legendre transformation of the Helmholtz free energy density. The Fourier potential is also included to account for heat conduction.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Strain-energy density and Newtonian viscosity}
\label{section: Chapter5/theory/elasticity}

Two types of strain-energy density functions are considered in this chapter: one for compressible Neo-Hookean materials, and the other for Hencky-type materials.
Following \cite{borden2016phase,ambati2016phase}, the strain energy is defined as
\begin{subequations}
  \begin{align}
    \psi^e               & =  g^e \psi^e_\activepart + \psi^e_\inactivepart,                                                                                                          \\
    \psi^e_\activepart   & = \mathbb{H}_1(J)\left\{ \dfrac{1}{2}K\left[ \dfrac{1}{2}(J^2-1) - \ln(J) \right] \right\} + \dfrac{1}{2}G\left( \overbar{\bfC}:{\bfC^p}^{-1} - 3 \right), \\
    \psi^e_\inactivepart & = \left( 1-\mathbb{H}_1(J) \right) \left\{ \dfrac{1}{2}K\left[ \dfrac{1}{2}(J^2-1) - \ln(J) \right] \right\},                                              
  \end{align}
\end{subequations}
where $K$ is the bulk modulus, $G$ is the shear modulus, $\mathbb{H}_a(x)$ is the Heaviside function with the jump located at $x = a$, $\bfC = \defgrad^T \defgrad$ is the right Cauchy-Green strain tensor, $\overbar{\bfC} = J^{-2/3}\bfC$ is the volume-preserving part of the right Cauchy-Green strain tensor, $\bfC^p = {\defgrad^p}^T \defgrad^p$ is the plastic counterpart of the right Cauchy-Green strain, and $g^e$ is the elastic degradation function (to be defined). We note that the kinematic state variable $\defgrad$ enters the potential through $\bfC$ and $\bfC^p$ only, according to the principle of frame indifference.
The strain energy is split into an active part (with the subscript $\activepart$) and an inactive part (with the subscript $\inactivepart$) such that fracture is associated with only volumetric expansion and deviatoric deformation. The corresponding force conjugate per \eqref{eq: constitutive restrictions} is given as
\begin{subequations}
  \begin{align}
    \bfP^\text{eq}          & = \psi^e_{, \defgrad} = \bs{\tau}\defgrad^{-T},                \\
    \bs{\tau}               & = g^e(d)\bs{\tau}_\activepart + \bs{\tau}_\inactivepart,       \\
    \bs{\tau}_\activepart   & = \dfrac{1}{2}\mathbb{H}_1(J)K(J^2-1)\bs{I} + G\dev(\bs{b}^e), \\
    \bs{\tau}_\inactivepart & = \dfrac{1}{2}(1-\mathbb{H}_1(J))K(J^2-1)\bs{I}.               
  \end{align}
\end{subequations}

Another suitable hyperelastic material based on a volumetric-deviatoric decomposition is given in \cite{brandon2020cohesive} as
\begin{subequations}
  \begin{align}
    \psi^e               & =  g^e \psi^e_\activepart + \psi^e_\inactivepart,                                     \\
    \psi^e_\activepart   & = \dfrac{1}{2} K \macaulay{\tr(\strain^e)}_+^2 + G \dev{\strain^e} : \dev{\strain^e}, \\
    \psi^e_\inactivepart & = \dfrac{1}{2} K \macaulay{\tr(\strain^e)}_-^2,                                       
  \end{align}
\end{subequations}
where $\strain^e = \frac{1}{2} \ln\left( \bfC^e \right)$ is the logarithmic elastic strain (also referred to as Hencky strain) based on the elastic right Cauchy-Green strain. The corresponding force conjugate is given as
\begin{align}
  \bfP^\text{eq}     & = {\defgrad^e}^{-T} \bfM {\defgrad^p}^{-T},                 \\
  \bfM               & = g^e \bfM_\activepart + \bfM_\inactivepart,                \\
  \bfM_\activepart   & = K \macaulay{\tr(\strain^e)}_+ \bfI + 2 G \dev{\strain^e}, \\
  \bfM_\inactivepart & = K \macaulay{\tr(\strain^e)}_- \bfI.                       
\end{align}

The dual kinetic potential ${\psi^e}^*$ is defined as
\begin{subequations}
  \begin{align}
    {\psi^e}^* & = g^e J \left[ \dfrac{1}{2}\zeta \tr(\bfd)^2 + \eta \bfd:\bfd \right], \\
    \bfd       & = \sym\left( \dot{\defgrad}\defgrad^{-1} \right),                      
  \end{align}
\end{subequations}
where $\zeta$ and $\eta$ are damping coefficients for volume change and isochoric spin, respectively. Its thermodynamic conjugate can be written as
\begin{subequations}
  \begin{align}
    \bfP^\text{vis}    & = g^e J \stress^\text{vis} \defgrad^{-T}, \\
    \stress^\text{vis} & = \zeta \tr(\bfd) \bfI + 2 \eta \bfd.     
  \end{align}
\end{subequations}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Flow rule constraints and the yield surface}
\label{section: Chapter5/theory/plastic_flow}

The flow rule for $J_2$-plasticity is defined as
\begin{subequations}\label{eq: minimization}
  \begin{align}
    \tr\left( \dot{\defgrad}^p{\defgrad^p}^{-1} \right) = 0, \label{eq: J2 flow rule constraint 1} \\
    \norm{\dot{\defgrad}^p{\defgrad^p}^{-1}}^2 - \frac{3}{2} \abs{\epdot}^2 = 0, \label{eq: J2 flow rule constraint 2}
  \end{align}
\end{subequations}
where \eqref{eq: J2 flow rule constraint 1} enforces the isochoric nature of plastic flow, and \eqref{eq: J2 flow rule constraint 2} normalizes the effective plastic strain to be uniaxial.

Following the variational framework, minimizing the objective jointly with respect to $\dot{\defgrad}^p$ and $\epdot$, subject to the constraints \eqref{eq: plastic irreversibility}, \eqref{eq: J2 flow rule constraint 1} and \eqref{eq: J2 flow rule constraint 2}, is equivalent to minimizing the Lagrangian (point-wise)
\begin{equation}
  \begin{aligned}
    \mathcal{L}^p(\dot{\defgrad}^p, \epdot, \phi^p, \lambda_1, \lambda_2) = & \ \bfT : \dot{\defgrad}^p + Y \epdot + \phi^p\epdot + \lambda_1\tr\left( \dot{\defgrad}^p{\defgrad^p}^{-1} \right) \\
                                                                            & \ + \lambda_2 \left( \norm{\dot{\defgrad}^p{\defgrad^p}^{-1}}^2 - \frac{3}{2} \abs{\epdot}^2 \right),              
  \end{aligned}
\end{equation}
where $\phi^p \leqslant 0$, $\lambda_1$, and $\lambda_2$ are Lagrange multipliers. The minimizer satisfies the following conditions (for any variations in the admissible space):
\begin{subequations}
  \begin{align}
    \mathcal{L}^p_{, \dot{\defgrad}^p} : \delta \dot{\defgrad}^p & = \bfT : \delta \dot{\defgrad}^p + \lambda_1{\defgrad^p}^{-T} : \delta \dot{\defgrad}^p + 2\lambda_2\dot{\defgrad}^p{\defgrad^p}^{-1}{\defgrad^p}^{-T} : \delta \dot{\defgrad}^p = 0, \label{eq: KKT Fp} \\
    \mathcal{L}^p_{, \epdot}\delta \epdot                        & = \psi^p_{, \ep}(\ep, d) \delta \epdot + \phi^p \delta \epdot - 3 \lambda_2 \abs{\epdot} \delta \epdot = 0, \label{eq: KKT ep}                                                                           \\
    \mathcal{L}^p_{, \phi^p} \delta \phi^p                       & = \epdot \delta \phi^p = 0, \label{eq: KKT lambda1}                                                                                                                                                      \\
    \mathcal{L}^p_{, \lambda_1} \delta \lambda_1                 & = \tr\left( \dot{\defgrad}^p{\defgrad^p}^{-1} \right) \delta \lambda_1 = 0, \label{eq: KKT lambda2}                                                                                                      \\
    \mathcal{L}^p_{, \lambda_2} \delta \lambda_2                 & = \left( \norm{\dot{\defgrad}^p{\defgrad^p}^{-1}}^2 - \frac{3}{2} \abs{\epdot}^2 \right) \delta \lambda_2 = 0. \label{eq: KKT lambda3}                                                                   
  \end{align}
\end{subequations}
Solving \eqref{eq: KKT Fp}, \eqref{eq: KKT lambda2}, and \eqref{eq: KKT lambda3} gives $\lambda_1$ and $\lambda_2$ as
\begin{align}
  \lambda_1 = -\dfrac{1}{3}\tr(\bfM), \quad \lambda_2 = \dfrac{1}{2}\sqrt{\dfrac{2}{3}}\dfrac{\norm{\dev(\bfM)}}{\abs{\epdot}},
\end{align}
where $\bfM = -\bfT\bfP^T$ is the Mandel stress, and the standard Prandtl-Reuss flow rule is recovered:
\begin{align}\label{eq: flow rule}
  \dot{\defgrad}^p{\defgrad^p}^{-1} = \epdot \bfN^p, \quad \bfN^p = \sqrt{\dfrac{3}{2}}\dfrac{\dev(\bfM)}{\norm{\dev(\bfM)}}.
\end{align}
Next, the plastic loading/unloading conditions follow from \eqref{eq: KKT ep} \& \eqref{eq: KKT lambda1} with the substitution of $\lambda_2$:
\begin{align}
  \phi^p \leqslant 0, \quad \epdot \geqslant 0, \quad \phi^p\epdot = 0,
\end{align}
where $\phi^p$ is referred to as the yield function or the yield surface, i.e.
\begin{align}
  \phi^p & = \norm{\dev(\bfM)} - \sqrt{\dfrac{2}{3}} Y = \norm{\dev(\bfM)} - \sqrt{\dfrac{2}{3}} \left( Y^\text{eq} + Y^\text{vis} \right).  \label{eq: yield surface} 
\end{align}
It is convenient to define $\bar{\sigma} = \norm{\dev(\bfM)}$ as the effective stress for the following discussions.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Plastic energy density and its rate sensitivity}
\label{section: Chapter5/theory/flow_stress}

Three commonly used plastic energy density functions are considered in this chapter. The first plastic energy density ressembles a simple linear hardening law:
\begin{subequations}
  \begin{align}
    \psi^p      & = g^p \left( \sigma_y \ep + \dfrac{1}{2} H \ep^2 \right), \\
    Y^\text{eq} & = g^p (\sigma_y + H \ep),                                 
  \end{align}
\end{subequations}
where $g^p = \hat{g}^p(d)$ is the plastic degradation function, $\sigma_y$ is the yield stress, and $H$ is the hardening modulus.

The second plastic energy density recovers the commonly used power-law hardening:
\begin{subequations}
  \begin{align}
    \psi^p      & = g^p \dfrac{n}{n+1} \sigma_y \epsilon_0 \left[ \left( 1 + \dfrac{\ep}{\epsilon_0} \right)^{(n+1)/n} - 1 \right], \\
    Y^\text{eq} & = g^p \sigma_y \left( 1 + \dfrac{\ep}{\epsilon_0} \right)^{1/n},                                                  
  \end{align}
\end{subequations}
where $n$ is the power-law exponent and $\epsilon_0$ is the characteristic plastic strain.

The third type of plastic energy density incorporates thermal softening according to the Arrhenius law:
\begin{subequations}
  \begin{align}
    \psi^p      & = g^p \sigma_y^T \ep, \quad \sigma_y^T = \dfrac{\sigma_y}{\exp\left( -\dfrac{Q}{RT} \right)}, \label{eq: temperature dependent flow stress} \\
    Y^\text{eq} & = g^p \sigma_y^T,                                                                                                                           
  \end{align}
\end{subequations}
where $\sigma_0$ is the reference yield stress, $Q$ is the activation energy, $R$ is the ideal gas constant. Note that since in this case $Y^\text{eq}$ depends on $T$, it leads to cooling due to thermal softening \eqref{eq: heat generation due to energetic terms}, i.e.
\begin{align}
  \delta_T = TY^\text{eq}_T\epdot = T g^p {\sigma_y^T}_{,T}\epdot, \quad {\sigma_y^T}_{,T} = \dfrac{-QR}{T^2} \sigma_y^T.
\end{align}

Rate sensitivity of the yield surface can be introduced through the plastic dual kinetic potential
\begin{subequations}
  \begin{align}
    {\psi^p}^*   & = g^p \dfrac{m}{m+1} \sigma_y \dot{\epsilon}_0 \left( \dfrac{\epdot}{\dot{\epsilon_0}} \right)^{(m+1)/m}, \\
    Y^\text{vis} & = g^p \sigma_y \left( \dfrac{\epdot}{\dot{\epsilon_0}} \right)^{1/m},                                     
  \end{align}
\end{subequations}
where $m$ is the rate exponent, $\dot{\epsilon_0}$ is the characteristic plastic strain rate.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Viscous regularization of fracture propagation and the coalescence dissipation}
\label{section: Chapter5/theory/fracture}

The fracture dual kinetic potential is defined as
\begin{subequations}
  \begin{align}
    {\psi^f}^*   & = \dfrac{1}{2} v \dot{d}^2 - (1-\beta)\dfrac{\Gc}{c_0l}\alpha_{,d}\left( 1-e^{-\ep/\varepsilon_0} \right)\dot{d} + (1-C) \dfrac{\Gc}{c_0 l}\alpha_{, d}\dot{d}, \label{eq: fracture dual kinetic potential} \\
    f^\text{vis} & = v \dot{d} + \left[ (1-C) - (1-\beta) \left( 1-e^{-\ep/\varepsilon_0} \right) \right] \dfrac{\Gc}{c_0 l} \alpha_{, d},                                                                                     
  \end{align}
\end{subequations}
where the first term in \eqref{eq: fracture dual kinetic potential} describes the viscous dissipation of crack propagation and $v$ is the kinetic viscosity for crack propagation.
The second term introduces a novel representation of the dissipation (hereinafter referred to as the \textit{coalescence dissipation}) associated with the development of the fracture process zone in ductile materials, such as through the evolution of voids, defects and dislocations. It models an exponential decay in the effective fracture toughness as defects increase, with the parameter $0 < \beta \leqslant 1 $ controlling the ratio between the final fracture toughness and the initial fracture toughness.

It is assumed that the fracture process can be decomposed into an energetic part and a dissipative part, i.e.
\begin{align}
  \psi^f = \dfrac{\Gc}{c_0 l} \left( C\alpha(d) + l^2 \grad d \cdot \grad d \right), \label{eq: modified fracture energy} \\
\end{align}
where $C$ denotes the fraction of the fracture process that is energetic. The dissipative part is the third term in \eqref{eq: fracture dual kinetic potential}.

\begin{remark}
  Consider the more strict form of the dissipation inequality where each of the thermodynamic processes is dissipative. For the process related to the fracture dissipation, that is
  \begin{align*}
    f^\text{vis} \dot{d}                                                                                                           & \geqslant 0  \\
    v \dot{d}^2 + \left[ (1-C) - (1-\beta) \left( 1-e^{-\ep/\varepsilon_0} \right) \right] \dfrac{\Gc}{c_0 l} \alpha_{, d} \dot{d} & \geqslant 0. 
  \end{align*}
  Since $\dot{d} \geqslant 0$ and $\alpha_{, d} \geqslant 0, \forall d \in [0, 1]$, the inequality requires $v > 0$ and $\beta - C \geqslant 0$.  In principle, $C$ can be chosen to calibrate the energetic and dissipative portions of the fracture potential in a specific model given sufficient experimental data, which would in turn set the lower bound for $\beta$.
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Fourier potential and heat conduction}

To account for isotropic heat conduction, the Fourier potential is defined as
\begin{align}
  \chi = \dfrac{1}{2}\kappa\btg\cdot\btg, \label{eq: chapter 5 fourier potential}
\end{align}
where $\kappa$ is the isotropic heat conduction coefficient. Recall that $\btg = - \grad T / T$ is the normalized thermal gradient. The resulting conductive heat flux is defined as
\begin{align}
  \bth = -\chi_{,\btg} = \kappa \grad T. \label{eq: conductive heat flux}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{The governing equations}

Following the variational framework, substituting \eqref{eq: chapter 5 helmholtz}, \eqref{eq: chapter 5 dual kinetic potential} and \eqref{eq: chapter 5 fourier potential} into the problem statement \eqref{eq: inf sup problem}, the governing equations can be obtained as
\begin{align}
  \rho_0\bta       & =\divergence \bfP,                                \\
  v\dot{d}         & =\divergence \bs{\xi} - f          ,              \\
  \rho_0c_v\dot{T} & = \rho_0 q - \divergence \bth + \delta + \delta_T 
\end{align}
supplemented by the constitutive relations including the stress-strain relations presented in \Cref{section: Chapter5/theory/elasticity}, the yield surface and loading/unloading conditions presented in \Cref{section: Chapter5/theory/plastic_flow,section: Chapter5/theory/flow_stress}, the modified fracture thermodynamic conjugates \Cref{section: Chapter5/theory/fracture}, and the conductive heat flux \eqref{eq: conductive heat flux}. Substituting all of them into the governing equations, the fracture evolution equation can be expanded as
\begin{align}
  v\dot{d}      & =\divergence \dfrac{2\Gc l}{c_0} \grad d - \left( \dfrac{\widehat{\Gc}}{c_0 l}\alpha_{,d} + \psi^d \right), \label{eq: modified fracture evolution} \\
  \psi^d        & = \psi^e_{,d} + \psi^p_{,d}, \label{eq: fracture driving energy}                                                                                    \\
  \widehat{\Gc} & = g^c \Gc, \quad g^c = 1-(1-\beta)\left( 1-e^{-\ep/\varepsilon_0} \right),                                                                          
\end{align}
where $\psi^d$ is referred to as the fracture driving energy density. The heat conduction equation can be expanded as
\begin{align}
  \rho_0c_v\dot{T} & = \rho_0 q + \divergence \kappa \grad T + \delta + \delta_T,                 \\
  \delta           & = \bfP^\text{vis}:\dot{\defgrad} + Y^\text{vis}\epdot + f^\text{vis}\dot{d}, \\
  \delta_T         & = -g^p \dfrac{QR}{T} \sigma_y^T\epdot.                                       
\end{align}
Note that $\delta_T$ is only present if thermal softening in the flow stress is incorporated following the Arrhenius law, e.g. \eqref{eq: temperature dependent flow stress}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{A power-law approximation to the yield surface}

A common task in engineering applications is to account for the dependence of yield surface on the strain-rate. To that end, consistent viscoplasticity models and Perzyna viscoplasticity models are proposed. The consistent viscoplasticity model has been presented in \Cref{section: Chapter5/theory/flow_stress} by incorporating a plastic dual kinetic potential. The Perzyna viscoplasticity models typically employ a relation between the effective plastic strain rate and the effective stress of the following general form:
\begin{align}
  \epdot = \mathscr{P}(\bar{\sigma}).
\end{align}
A commonly used temperature dependent Perzyna viscoplasticity model is
\begin{align}
  \epdot = A\left( \dfrac{\bar{\sigma}}{\sigma_0} \right)^n\exp\left( -\dfrac{Q}{RT} \right). \label{eq: common perzyna model}
\end{align}
It is particularly difficult, if not impossible, to introduce a functional whose variation in $\epdot$ leads to this widely used model. However, it is straight-forward to show that the a form similar to \eqref{eq: common perzyna model} is an \emph{approximation} to the consistent plasticity model with Arrhenius-law temperature dependence \eqref{eq: temperature dependent flow stress}. Consider the following power-law relation between $\epdot$ and $\bar{\sigma}$,
\begin{align}
  \epdot = A\left( \dfrac{\bar{\sigma}}{\sigma_y} \right)^n, \label{eq: power law approximation}
\end{align}
where $A$ is the reference strain rate and $\sigma_y$ is the yield stress. It can be shown that \eqref{eq: power law approximation} is equivalent to the following KKT conditions
\begin{align}
  \phi^p = \bar{\sigma} - \sigma_y \leqslant 0, \quad \epdot \geqslant 0, \quad \phi^p\epdot = 0, \label{eq: consistent KKT}
\end{align}
as $n \to \infty$. To sketch that, first introduce the semidiscrete form of the effective stress: Given the state at $t = t_1$, and the total deformation gradient at $t = t_2$, performing the point-wise plasticity update from $t_1$ to $t_2$ requires the following discretization of the effective stress (where the time discretization can be arbitrary):
\begin{align}
  \bar{\sigma} = \norm{\dev(\widehat{\bfM}(\defgrad))} - \widehat{\bfM}\left( \int\limits_{t_1}^{t_2} \epdot N^p \diff{t} \right) : \bfN^p, \label{eq: semidiscrete yield surface}
\end{align}
where $\bfM = \widehat{\bfM}(\defgrad^e)$ is the Mandel stress. Consider the following three cases:
\begin{itemize}
  \item $\bar{\sigma} < \sigma_y$: it is immediate that $\lim_{n\to\infty} \epdot = 0$ assuming the relation \eqref{eq: power law approximation};
  \item $\bar{\sigma} = \sigma_y$: $\epdot = A$ according to \eqref{eq: power law approximation}.
  \item Suppose $\bar{\sigma} > \sigma_y$, then $\epdot \to \infty$ as $n \to \infty$. Then, according to \eqref{eq: semidiscrete yield surface} (and recall the growth conditions on $\psi^e$), $\bar{\sigma} \to -\infty$, which contradicts with the assumption that $\bar{\sigma} > \sigma_y > 0$. Hence $\bar{\sigma} \leqslant \sigma_y$.
\end{itemize}
Summarizing the aforementioned cases recovers the KKT conditions \eqref{eq: consistent KKT} as $n \to \infty$. Next, substitute the flow stress with Arrhenius-law temperature dependence into \eqref{eq: power law approximation}, we arrive at the following Perzyna model:
\begin{align}
  \epdot = A \left( \dfrac{\bar{\sigma}}{g^p \sigma_0} \right)^n \exp\left( -\dfrac{nQ}{RT} \right). \label{eq: variational perzyna}
\end{align}
Note that the only difference between \eqref{eq: common perzyna model} and \eqref{eq: variational perzyna} is in the numerator of the exponential term. Therefore, it only requires a straight-forward re-calibration to fit the existing materials with calibrated Perzyna models in the form of \eqref{eq: common perzyna model} into the current variational framework, knowing that the KKT conditions \eqref{eq: consistent KKT} are relaxed with a finite value of $n$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Variational constitutive updates}

In this section, we present the variational constitutive update using the Hencky-type elasticity model. A similar plasticity constitutive update for the compressible Neo-Hookean material can be found in \cite{borden2016phase}.

Since $\defgrad^p$ and $\ep$ are local, i.e. confined to a material point, the variational constitutive updates can be performed point-wise considering the incremental form of the local energy density \eqref{eq: local energy density}: Given the state $\Lambda_n$ at time $t_n$, the incremental local energy density can be expressed as
\begin{equation}
  \begin{aligned}
    I_n(\Lambda_{n+1}, T_{n+1}; \Lambda_n, T_n) = & \ \psi^e(\strain^e_{n+1}, d_{n+1}) + \psi^p(\ep_{n+1}, d_{n+1}, T_{n+1})            \\
                                                  & \ - \left( \psi^e(\strain^e_n, d_n) + \psi^p(\ep_n, d_n, T_n) \right)               \\
                                                  & \ + \Delta t {\psi^p}^*\left( \dfrac{\Delta \ep}{\Delta t}, T_{n+1}; d_{n} \right). 
  \end{aligned}
\end{equation}
Note that only relevant terms are included. Using the exponential integration rule \cite{weber1990finite}
\begin{align}
  \defgrad^p_{n+1} = \exp\left( \Delta\ep \bfN^p_{n+1} \right) \defgrad^p_n,
\end{align}
the elastic deformation gradient can be written as
\begin{align}
  \defgrad^e_{n+1} = \defgrad^{e,\text{tr}}\exp\left( \Delta\ep \bfN^p_{n+1} \right), \quad \defgrad^{e,\text{tr}} = \defgrad_{n+1} {\defgrad^p_n}^{-1},
\end{align}
where $\defgrad^{e,\text{tr}}$ is the trial elastic deformation gradient assuming no plastic flow over the time step. Similarly, it can shown that the elastic right Cauchy-Green strain can be defined as
\begin{align}
  \bfC^e_{n+1} = \bfC^{e,\text{tr}} \exp\left( -2\Delta\ep\bfN^p_{n+1} \right).
\end{align}
Then, the elastic Hencky strain can be written as
\begin{align}
  \strain^e_{n+1} = \strain^{e,\text{tr}} - \Delta\ep\bfN^p_{n+1}, \quad \strain^{e,\text{tr}} = \dfrac{1}{2}\ln\left( \bfC^{e,\text{tr}} \right),
\end{align}
and the trial conjugate stress can be derived as
\begin{align}
  \bfM^\text{tr} = \psi^e_{,\strain^{e,\text{tr}}} = \widehat{\bfM}\left( \strain^{e,\text{tr}}, d_{n+1} \right).
\end{align}
Next, minimizing the incremental local energy density subject the flow rule constraints (similar to the derivation in \Cref{section: Chapter5/theory/plastic_flow}) yields
\begin{subequations}
  \begin{align}
    \begin{split}
      \phi^p(\Delta\ep) = &\ \bfM^\text{tr}:\bfN^p_{n+1} - \widehat{\bfM}\left( \Delta\ep \bfN^p_{n+1} \right):\bfN^p_{n+1} \\
      &\ - Y^\text{eq}\left( \ep_n + \Delta\ep, d_{n+1}, T_{n+1} \right) - Y^\text{vis}\left( \dfrac{\Delta \ep}{\Delta t}; d_{n} \right) ,
    \end{split}                                                                                                                                                                      \\
    \bfN^p_{n+1} = & \  \dfrac{3}{2} \dfrac{\dev\left( \bfM^\text{tr} \right)}{\bar{\sigma}^\text{tr}}, \quad \bar{\sigma}^\text{tr} = \sqrt{\dfrac{3}{2}}\norm{\dev\left( \bfM^\text{tr} \right)}, 
  \end{align}
\end{subequations}
