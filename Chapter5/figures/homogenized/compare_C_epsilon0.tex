\begin{figure}[htb!]
  \centering
  \begin{subfigure}[b]{0.4\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/homogenized/compare_C_epsilon0/C/stress_strain}
    \begin{tikzpicture}
      \begin{axis}[
          width=\textwidth,
          height=0.75\textwidth,
          xmin=0,
          xmax=0.05125,
          ymin=0,
          ymax=1.1,
          xlabel=$\varepsilon$,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          scaled x ticks=false,
          legend style={
              at={(0.15,0.05)},
              anchor=south west,
              nodes={scale=0.8, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \addplot +[red] table[x expr=\thisrowno{8},y expr=\thisrowno{4}/25.875,col sep=comma]{Chapter5/data/homogenized/C_0.3_beta_0.5_e0_0.001.csv};
        \addplot +[black] table[x expr=\thisrowno{8},y expr=\thisrowno{7}/320,col sep=comma]{Chapter5/data/homogenized/C_0.3_beta_0.5_e0_0.001.csv};
        \legend{$g^c(\ep)$,$\sigma/\sigma_y$}
      \end{axis}
    \end{tikzpicture}
    \caption{}
    \label{fig: Chapter5/homogenized/compare_C_epsilon0/C/stress_strain}
  \end{subfigure}
  \begin{subfigure}[b]{0.4\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/homogenized/compare_C_epsilon0/C/energy}
    \begin{tikzpicture}
      \begin{axis}[
          width=\textwidth,
          height=0.75\textwidth,
          xmin=0,
          xmax=0.05125,
          ymin=0,
          ymax=1.3,
          xlabel=$\varepsilon$,ylabel=$\Psi c_0 l/ \Gc a^3$,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          scaled x ticks=false,
          legend style={
              at={(0.05,0.95)},
              anchor=north west,
              nodes={scale=0.6, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \path[name path=axis] (axis cs:0,0) -- (axis cs:0.05125,0);
        // external
        \addplot +[black, name path=EXT] table[x expr=\thisrowno{8},y expr=\thisrowno{2}/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.3_beta_0.5_e0_0.001.csv};
        // elastic
        \addplot [draw=none,name path=E,forget plot] table[x expr=\thisrowno{8},y expr=\thisrowno{1}/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.3_beta_0.5_e0_0.001.csv};
        \addplot [fill=green,fill opacity=0.5] fill between[of=E and axis];
        // plastic
        \addplot [draw=none,name path=EP,forget plot] table[x expr=\thisrowno{8},y expr=(\thisrowno{1}+\thisrowno{5})/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.3_beta_0.5_e0_0.001.csv};
        \addplot [fill=blue,fill opacity=0.5] fill between[of=EP and E];
        // fracture
        \addplot [draw=none,name path=EPF,forget plot] table[x expr=\thisrowno{8},y expr=(\thisrowno{1}+\thisrowno{5}+\thisrowno{3})/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.3_beta_0.5_e0_0.001.csv};
        \addplot [fill=brown,fill opacity=0.5] fill between[of=EP and EPF];
        // coalescence
        \addplot [fill=black,fill opacity=1, pattern=north west lines] fill between[of=EPF and EXT];
        \legend{external work, strain energy, plastic energy, fracture energy, fracture dissipation}
      \end{axis}
    \end{tikzpicture}
    \vspace{-12pt}
    \caption{}
    \label{fig: Chapter5/homogenized/compare_C_epsilon0/C/energy}
  \end{subfigure}
  
  \begin{subfigure}[b]{0.4\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/homogenized/compare_C_epsilon0/epsilon0/stress_strain}
    \begin{tikzpicture}
      \begin{axis}[
          width=\textwidth,
          height=0.75\textwidth,
          xmin=0,
          xmax=0.05125,
          ymin=0,
          ymax=1.1,
          xlabel=$\varepsilon$,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          scaled x ticks=false,
          legend style={
              at={(0.15,0.05)},
              anchor=south west,
              nodes={scale=0.8, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \addplot +[red] table[x expr=\thisrowno{8},y expr=\thisrowno{4}/25.875,col sep=comma]{Chapter5/data/homogenized/C_0.5_beta_0.5_e0_0.1.csv};
        \addplot +[black] table[x expr=\thisrowno{8},y expr=\thisrowno{7}/320,col sep=comma]{Chapter5/data/homogenized/C_0.5_beta_0.5_e0_0.1.csv};
        \legend{$g^c(\ep)$,$\sigma/\sigma_y$}
      \end{axis}
    \end{tikzpicture}
    \caption{}
    \label{fig: Chapter5/homogenized/compare_C_epsilon0/epsilon0/stress_strain}
  \end{subfigure}
  \begin{subfigure}[b]{0.4\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/homogenized/compare_C_epsilon0/epsilon0/energy}
    \begin{tikzpicture}
      \begin{axis}[
          width=\textwidth,
          height=0.75\textwidth,
          xmin=0,
          xmax=0.05125,
          ymin=0,
          ymax=1.3,
          xlabel=$\varepsilon$,ylabel=$\Psi c_0 l/ \Gc a^3$,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          scaled x ticks=false,
          legend style={
              at={(0.05,0.95)},
              anchor=north west,
              nodes={scale=0.6, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \path[name path=axis] (axis cs:0,0) -- (axis cs:0.05125,0);
        // external
        \addplot +[black, name path=EXT] table[x expr=\thisrowno{8},y expr=\thisrowno{2}/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.5_beta_0.5_e0_0.1.csv};
        // elastic
        \addplot [draw=none,name path=E,forget plot] table[x expr=\thisrowno{8},y expr=\thisrowno{1}/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.5_beta_0.5_e0_0.1.csv};
        \addplot [fill=green,fill opacity=0.5] fill between[of=E and axis];
        // plastic
        \addplot [draw=none,name path=EP,forget plot] table[x expr=\thisrowno{8},y expr=(\thisrowno{1}+\thisrowno{5})/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.5_beta_0.5_e0_0.1.csv};
        \addplot [fill=blue,fill opacity=0.5] fill between[of=EP and E];
        // fracture
        \addplot [draw=none,name path=EPF,forget plot] table[x expr=\thisrowno{8},y expr=(\thisrowno{1}+\thisrowno{5}+\thisrowno{3})/12937500000,col sep=comma]{Chapter5/data/homogenized/C_0.5_beta_0.5_e0_0.1.csv};
        \addplot [fill=brown,fill opacity=0.5] fill between[of=EP and EPF];
        // coalescence
        \addplot [fill=black,fill opacity=1, pattern=north west lines] fill between[of=EPF and EXT];
        \legend{external work, strain energy, plastic energy, fracture energy, fracture dissipation}
      \end{axis}
    \end{tikzpicture}
    \vspace{-12pt}
    \caption{}
    \label{fig: Chapter5/homogenized/compare_C_epsilon0/epsilon0/energy}
  \end{subfigure}
  \caption[The stress strain curve, the degradation for the fracture toughness, and the corresponding energy conservation for different values of $\epsilon_0$.]{(a, c) The stress strain curve and the degradation for the fracture toughness and (b, d) the corresponding energy conservation. In (a-b), $C=0.3$, $\beta=0.5$, $\varepsilon_0=0.001$, and $\dfrac{\psi_cc_0a}{\Gc}=0.0021$. In (c-d),  $C=\beta=0.5$, $\varepsilon_0=0.1$ and $\dfrac{\psi_cc_0a}{\Gc}=0.0012$. }
  \label{fig: Chapter5/homogenized/compare_C_epsilon0}
\end{figure}
