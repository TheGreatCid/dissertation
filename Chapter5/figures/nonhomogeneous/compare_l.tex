\begin{figure}[htb!]
  \centering
  \begin{subfigure}{0.45\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/nonhomogeneous/compare_l/EPPD}
    \begin{tikzpicture}
      \begin{axis}[
          colormap/jet,
          cycle list={[of colormap,samples of colormap=5]},
          width=\textwidth,
          height=0.8\textwidth,
          xmin=0,xmax=0.07,
          ymin=0,
          xlabel=$u_g/L$,ylabel=$F_x/(\sigma_y t)$,
          scaled x ticks=false,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          legend style={
              at={(0.1,0.05)},
              anchor=south west,
              nodes={scale=0.8, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.2_nx_20_EPPD.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.1_nx_40_EPPD.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.05_nx_80_EPPD.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.025_nx_160_EPPD.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.0125_nx_320_EPPD.csv};
        \legend{$l/r_p=0.0276$,$l/r_p=0.0138$,$l/r_p=0.0069$,$l/r_p=0.0034$,$l/r_p=0.0017$}
      \end{axis}
    \end{tikzpicture}
    \caption{E-P-PD}
    \label{fig: Chapter5/nonhomogeneous/compare_l/EPPD}
  \end{subfigure}
  \begin{subfigure}{0.45\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/nonhomogeneous/compare_l/EPD_beta_1}
    \begin{tikzpicture}
      \begin{axis}[
          colormap/jet,
          cycle list={[of colormap,samples of colormap=5]},
          width=\textwidth,
          height=0.8\textwidth,
          xmin=0,xmax=0.07,
          ymin=0,
          xlabel=$u_g/L$,ylabel=$F_x/(\sigma_y t)$,
          scaled x ticks=false,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          legend style={
              at={(0.1,0.05)},
              anchor=south west,
              nodes={scale=0.8, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_2_nx_20_beta_1.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_1_nx_40_beta_1.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.5_nx_80_beta_1.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.25_nx_160_beta_1.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.125_nx_320_beta_1.csv};
        \legend{$l/r_p=0.276$,$l/r_p=0.138$,$l/r_p=0.069$,$l/r_p=0.034$,$l/r_p=0.017$}
      \end{axis}
    \end{tikzpicture}
    \caption{E-P-D with $\beta = 1$}
    \label{fig: Chapter5/nonhomogeneous/compare_l/EPD_beta_1}
  \end{subfigure}
  
  \begin{subfigure}{0.45\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/nonhomogeneous/compare_l/EPD_beta_0.8}
    \begin{tikzpicture}
      \begin{axis}[
          colormap/jet,
          cycle list={[of colormap,samples of colormap=5]},
          width=\textwidth,
          height=0.8\textwidth,
          xmin=0,xmax=0.07,
          ymin=0,
          xlabel=$u_g/L$,ylabel=$F_x/(\sigma_y t)$,
          scaled x ticks=false,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          legend style={
              at={(0.1,0.05)},
              anchor=south west,
              nodes={scale=0.8, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_2_nx_20_beta_0.8.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_1_nx_40_beta_0.8.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.5_nx_80_beta_0.8.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.25_nx_160_beta_0.8.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.125_nx_320_beta_0.8.csv};
        \legend{$l/r_p=0.276$,$l/r_p=0.138$,$l/r_p=0.069$,$l/r_p=0.034$,$l/r_p=0.017$}
      \end{axis}
    \end{tikzpicture}
    \caption{E-P-D with $\beta = 0.8$}
    \label{fig: Chapter5/nonhomogeneous/compare_l/EPD_beta_0.8}
  \end{subfigure}
  \begin{subfigure}{0.45\textwidth}
    \centering
    \tikzsetnextfilenamesafe{Chapter5/nonhomogeneous/compare_l/EPD_beta_0.6}
    \begin{tikzpicture}
      \begin{axis}[
          colormap/jet,
          cycle list={[of colormap,samples of colormap=5]},
          width=\textwidth,
          height=0.8\textwidth,
          xmin=0,xmax=0.07,
          ymin=0,
          xlabel=$u_g/L$,ylabel=$F_x/(\sigma_y t)$,
          scaled x ticks=false,
          xticklabel style={
              /pgf/number format/fixed,
              /pgf/number format/precision=2
            },
          legend style={
              at={(0.1,0.05)},
              anchor=south west,
              nodes={scale=0.8, transform shape},
              fill=white,
              fill opacity=0.8,
              draw opacity=1,
              text opacity=1,
              cells={align=left}
            },
          legend cell align={left},
          every axis plot/.append style={thick,no marks}
        ]
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_2_nx_20_beta_0.6.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_1_nx_40_beta_0.6.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.5_nx_80_beta_0.6.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.25_nx_160_beta_0.6.csv};
        \addplot  table[x expr=\thisrowno{0}/10,y expr=\thisrowno{1}/320, col sep=comma]{Chapter5/data/nonhomogeneous/force_disp_l_0.125_nx_320_beta_0.6.csv};
        \legend{$l/r_p=0.276$,$l/r_p=0.138$,$l/r_p=0.069$,$l/r_p=0.034$,$l/r_p=0.017$}
      \end{axis}
    \end{tikzpicture}
    \caption{E-P-D with $\beta = 0.6$}
    \label{fig: Chapter5/nonhomogeneous/compare_l/EPD_beta_0.6}
  \end{subfigure}
  \caption{Normalized load-displacement curves obtained for (a) the E-P-PD model and (b-d) the E-P-D model with different values of $\beta$. Unit thickness is assumed.}
  \label{fig: Chapter5/nonhomogeneous/compare_l}
\end{figure}
